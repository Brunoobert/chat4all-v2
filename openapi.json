{"openapi":"3.1.0","info":{"title":"Chat4All v2","version":"0.2.0"},"paths":{"/v1/files/initiate":{"post":{"summary":"Initiate Upload","operationId":"initiate_upload_v1_files_initiate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileInit"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileInitResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/files/{file_id}/chunk":{"post":{"summary":"Upload Chunk","operationId":"upload_chunk_v1_files__file_id__chunk_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"file_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"File Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_chunk_v1_files__file_id__chunk_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/files/{file_id}/complete":{"post":{"summary":"Complete Upload","operationId":"complete_upload_v1_files__file_id__complete_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"file_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"File Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileCompleteResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/messages":{"post":{"summary":"Post Message","operationId":"post_message_v1_messages_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageIn"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/messages/{message_id}/status":{"patch":{"summary":"Update Status Callback","description":"Recebe callback dos conectores e atualiza status no banco","operationId":"update_status_callback_v1_messages__message_id__status_patch","parameters":[{"name":"message_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Message Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageStatusUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/token":{"post":{"summary":"Login","operationId":"login_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/conversations":{"get":{"summary":"List Conv","operationId":"list_conv_v1_conversations_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ConversationOut"},"type":"array","title":"Response List Conv V1 Conversations Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"summary":"Create Conv","operationId":"create_conv_v1_conversations_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/conversations/{conversation_id}/messages":{"get":{"summary":"Get History","operationId":"get_history_v1_conversations__conversation_id__messages_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Conversation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/webhooks":{"get":{"tags":["Integrations"],"summary":"List Webhooks","operationId":"list_webhooks_v1_webhooks_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["Integrations"],"summary":"Register Webhook","description":"Registra uma URL externa para receber notificações de eventos.","operationId":"register_webhook_v1_webhooks_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/users/channels":{"get":{"tags":["Users"],"summary":"Get Channels","operationId":"get_channels_v1_users_channels_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["Users"],"summary":"Link Channel","description":"Vincula um telefone (WhatsApp) ou @ (Instagram) ao usuário.","operationId":"link_channel_v1_users_channels_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChannelLink"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/presence/heartbeat":{"post":{"tags":["Presence"],"summary":"Heartbeat","description":"Endpoint chamado pelo Frontend a cada 30s para dizer 'Estou Online'.","operationId":"heartbeat_v1_presence_heartbeat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PresenceUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/v1/presence/{username}":{"get":{"tags":["Presence"],"summary":"Get Presence","operationId":"get_presence_v1_presence__username__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string","title":"Username"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_login_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_token_post"},"Body_upload_chunk_v1_files__file_id__chunk_post":{"properties":{"chunk_index":{"type":"integer","title":"Chunk Index"},"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["chunk_index","file"],"title":"Body_upload_chunk_v1_files__file_id__chunk_post"},"ChannelLink":{"properties":{"channel_type":{"type":"string","title":"Channel Type"},"identifier":{"type":"string","title":"Identifier"}},"type":"object","required":["channel_type","identifier"],"title":"ChannelLink"},"ChannelType":{"type":"string","enum":["whatsapp","instagram","telegram","all"],"title":"ChannelType"},"ConversationCreate":{"properties":{"type":{"type":"string","title":"Type"},"members":{"items":{"type":"string"},"type":"array","title":"Members"},"metadata":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Metadata","default":{}}},"type":"object","required":["type","members"],"title":"ConversationCreate"},"ConversationOut":{"properties":{"conversation_id":{"type":"string","format":"uuid","title":"Conversation Id"},"type":{"type":"string","title":"Type"},"members":{"items":{"type":"string"},"type":"array","title":"Members"},"metadata":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Metadata","default":{}},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["conversation_id","type","members","created_at"],"title":"ConversationOut"},"FileCompleteResponse":{"properties":{"file_id":{"type":"string","format":"uuid","title":"File Id"},"download_url":{"type":"string","title":"Download Url"},"message":{"type":"string","title":"Message"}},"type":"object","required":["file_id","download_url","message"],"title":"FileCompleteResponse"},"FileInit":{"properties":{"filename":{"type":"string","title":"Filename"},"total_size":{"type":"integer","title":"Total Size"},"content_type":{"type":"string","title":"Content Type"}},"type":"object","required":["filename","total_size","content_type"],"title":"FileInit"},"FileInitResponse":{"properties":{"file_id":{"type":"string","format":"uuid","title":"File Id"},"chunk_size":{"type":"integer","title":"Chunk Size","default":5242880},"total_chunks":{"type":"integer","title":"Total Chunks"}},"type":"object","required":["file_id","total_chunks"],"title":"FileInitResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MessageIn":{"properties":{"chat_id":{"type":"string","format":"uuid","title":"Chat Id"},"content":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Content"},"file_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"File Id"},"channels":{"anyOf":[{"items":{"$ref":"#/components/schemas/ChannelType"},"type":"array"},{"type":"null"}],"title":"Channels","default":["all"]}},"type":"object","required":["chat_id"],"title":"MessageIn"},"MessageResponse":{"properties":{"status":{"type":"string","title":"Status","default":"accepted"},"message_id":{"type":"string","format":"uuid","title":"Message Id"}},"type":"object","title":"MessageResponse"},"MessageStatusUpdate":{"properties":{"status":{"type":"string","title":"Status"},"conversation_id":{"type":"string","format":"uuid","title":"Conversation Id"}},"type":"object","required":["status","conversation_id"],"title":"MessageStatusUpdate"},"PresenceUpdate":{"properties":{"status":{"type":"string","title":"Status"}},"type":"object","required":["status"],"title":"PresenceUpdate"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type"}},"type":"object","required":["access_token","token_type"],"title":"Token"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WebhookCreate":{"properties":{"url":{"type":"string","title":"Url"},"events":{"items":{"type":"string"},"type":"array","title":"Events","default":["message.delivered","message.read"]},"secret":{"type":"string","title":"Secret"}},"type":"object","required":["url","secret"],"title":"WebhookCreate"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"token"}}}}}}